<!-- ✅ 只列出「有改的區塊」，其餘 CSS / HTML 與你原本一模一樣 -->

<!-- 🔁 video-pane 區塊：雙影片 -->
<section class="video-pane">
  <div id="videoCard" class="video-card">
    <!-- 聆聽影片（預設） -->
    <video id="videoListening"
           src="./doctor_listening.mp4"
           autoplay muted loop playsinline></video>

    <!-- 說話影片 -->
    <video id="videoTalking"
           src="./doctor_talking.mp4"
           autoplay muted loop playsinline
           style="display:none"></video>

    <div class="badge">
      <span class="status-dot"></span>AI 虛擬醫師（非真人）
    </div>
  </div>

  <div class="video-footer">
    這是 AI 預診助手模擬畫面，最終醫療判斷由真正醫師提供。
    <div class="warn">
      若出現胸痛、呼吸困難、意識改變等急重症狀，請立即尋求急救協助。
    </div>
    <label style="margin-top:6px;display:inline-flex;align-items:center;font-size:12px;gap:4px;">
      <input type="checkbox" id="voice-toggle" checked />
      開啟語音回覆（建議接上耳機）
    </label>
  </div>
</section>

<script>
  /* ====== 新增：影片狀態控制 ====== */
  const $videoListening = document.getElementById("videoListening");
  const $videoTalking = document.getElementById("videoTalking");

  function setDoctorMode(mode) {
    if (mode === "talking") {
      $videoListening.style.display = "none";
      $videoTalking.style.display = "block";
      $videoTalking.play().catch(()=>{});
    } else {
      $videoTalking.style.display = "none";
      $videoListening.style.display = "block";
      $videoListening.play().catch(()=>{});
    }
  }

  /* ====== 覆蓋你原本的 speak()（只多影片切換） ====== */
  function speak(text) {
    if (!voiceEnabled) return;
    if (!("speechSynthesis" in window)) return;

    // 🔊 開始講話 → 換說話影片
    setDoctorMode("talking");
    markTalking();

    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "zh-TW";
    utter.rate = 1.0;
    utter.pitch = 1.0;

    utter.onend = () => {
      // ✅ 講完 → 換回聆聽影片
      setDoctorMode("listening");
    };

    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(utter);
  }

  // ✅ 頁面初始化：預設聆聽
  setDoctorMode("listening");
</script>
